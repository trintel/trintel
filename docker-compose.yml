version: '3.3'
services:
  # db:
  #   image: mysql:5.7
  #   restart: always
  #   environment:
  #     MYSQL_DATABASE: 'coolDB'
  #     # Password for root access
  #     MYSQL_ROOT_PASSWORD: 'pw' #only accessable from inside the docker network, so not that critical.
  #   expose:
  #     # <Port exposed> : < MySQL Port running inside container>
  #     - '3306:3306'
  #     # Where our data will be persisted
  #   volumes:
  #     - my-db:/var/lib/mysql

  trintel:
    image: b3zz/trintel:1.4.2
    # depends_on:
    #   - db
    ports:
      - '8082:8080'
    restart: always
    volumes:
      - trintel-database:/trintel-database
    environment:
      - spring.mail.host=smtp.strato.de
      - spring.mail.port=587
      - spring.mail.username=trintel@cau.zeppel.eu
      - spring.mail.password= #mysecurepassword.
      - spring.mail.properties.mail.smtp.auth=true
      - spring.mail.properties.mail.smtp.starttls.enable=true

  trintel-v2:
    image: b3zz/trintel:1.4.2
    ports:
      - '8083:8080'
    restart: always
    volumes:
      - trintel-database-v2:/trintel-database
    environment:
      - spring.mail.host=smtp.strato.de
      - spring.mail.port=587
      - spring.mail.username=trintel@cau.zeppel.eu
      - spring.mail.password= #mysecurepassword.
      - spring.mail.properties.mail.smtp.auth=true
      - spring.mail.properties.mail.smtp.starttls.enable=true

  filebeat:
    image: "docker.elastic.co/beats/filebeat:7.2.0"
    user: root
    volumes:
      - ./elastic-stack/filebeat.yml:/usr/share/filebeat/filebeat.yml:ro #TODO: this is a relative path. be careful.
      - /var/lib/docker:/var/lib/docker:ro
      - /var/run/docker.sock:/var/run/docker.sock

# Names our volume
volumes:
  trintel-database:
  trintel-database-v2:
